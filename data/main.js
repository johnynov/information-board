(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(46)},45:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(10),o=a.n(c);var d=function(e){var t=e.children,a=e.open,r=e.onClose;return n.a.useEffect(function(){if(a){var e=function(e){"Escape"===e.key&&r()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}},[a,r]),a?o.a.createPortal(n.a.createElement("div",{className:"modal-background"},n.a.createElement("div",{className:"modal-container"},n.a.createElement("div",{className:"modal"},t))),document.body):null},l=a(3),s=a.n(l),u=a(6),i=a(4),v=a(1),p=a(5),m=a.n(p);var f=function(e){var t=e.children;return n.a.createElement("div",{className:"action-container"},t)},b=a(9);function h(e,t,a){var r=Object(v.a)({},t),n=function(e,t){var a=e.name,r=e.value,n=Object(b.a)({},a,r),c=Object(b.a)({},a,t[a]),o=m.a.validate(n,c).error;return o?o.details[0].message:null}(e,a);return n?r[e.name]=n:delete r[e.name],r}function y(e,t){var a=m.a.validate(e,t,{abortEarly:!1}).error;if(!a)return null;var r={},n=!0,c=!1,o=void 0;try{for(var d,l=a.details[Symbol.iterator]();!(n=(d=l.next()).done);n=!0){var s=d.value;r[s.path[0]]=s.message}}catch(u){c=!0,o=u}finally{try{n||null==l.return||l.return()}finally{if(c)throw o}}return r}var E=a(8),O=a(7),w=a.n(O);w.a.defaults.baseURL="http://192.168.1.1";var g="/posts";function x(e){var t=g,a=e;return A("add advert",t,a),w.a.post(t,a)}function k(e){var t=e.id,a=Object(E.a)(e,["id"]),r="".concat(g,"/").concat(t);return A("update advert",r,a),w.a.patch(r,a)}function j(e){var t=e.id,a=e.password,r="".concat(g,"/").concat(t),n={password:a};return A("delete advert",r,n),w.a.delete(r,{data:n})}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r="%cRequest: ".concat(e,'\', url: "%s"').concat(a&&", payload: ");console.log(r,"color: orange; font-weight: bold;",w.a.defaults.baseURL+t,a)}var C="adverts:addAdvert";var M="adverts:updateAdvert";function N(e){return{type:M,advert:e}}var D="adverts:deleteAdvert";function T(e){return{type:D,advert:e}}var I=function(e){var t=e.data,a=e.errors,r=e.name,c=Object(E.a)(e,["data","errors","name"]),o=t[r],d=a[r],l=o.split("\n").length;return n.a.createElement("div",{className:"input-wrapper"},n.a.createElement("textarea",Object.assign({className:"input".concat(d?" with-error":""),id:r,name:r,value:o,rows:l},c)),d&&n.a.createElement("div",{className:"input-error"},d))};var S=function(e){var t=e.disabled,a=e.onClick,r=e.text;return n.a.createElement("button",{className:"btn",disabled:t,onClick:a},r)};var P=function(e){var t=e.data,a=e.errors,r=e.name,c=Object(E.a)(e,["data","errors","name"]),o=t[r],d=a[r];return n.a.createElement("div",{className:"input-wrapper"},n.a.createElement("input",Object.assign({className:"input".concat(d?" with-error":""),id:r,name:r,value:o},c)),d&&n.a.createElement("div",{className:"input-error"},d))},R={title:m.a.string().required().min(3).max(128).label("Title"),body:m.a.string().required().min(3).max(256).label("Content")},F={password:m.a.string().required().min(3).max(64).label("Password")};var q=function(e){var t=e.advert,a=e.onCancel,r=e.submitText,c=e.headerText,o=e.mode,d=e.dispatch,l=n.a.useState(function(e,t){switch(e){case"add":return{title:"",body:""};case"modify":return{title:t&&t.title||"",body:t&&t.body||"",password:""};case"delete":return{password:""};default:return null}}(o,t)),p=Object(i.a)(l,2),b=p[0],E=p[1],O=n.a.useState({}),w=Object(i.a)(O,2),g=w[0],A=w[1],M=n.a.useState(!1),D=Object(i.a)(M,2),q=D[0],L=D[1],U=n.a.useMemo(function(){return function(e){switch(e){case"add":return R;case"modify":return Object(v.a)({},R,F);case"delete":return F;default:return null}}(o)},[o]),B=n.a.useMemo(function(){var e=function(e,t){var a=m.a.validate(e,t,{abortEarly:!1}).error;return!Boolean(a)}(b,U),t=Object.keys(g).length;return e&&!t},[b,g,U]),J=n.a.useCallback(function(e){var t=e.currentTarget,a=function(e,t){var a=e.name,r=e.value,n=Object(v.a)({},t);return n[a]=r,n}(t,b),r=h(t,g,U);E(a),A(r)},[b,E,g,A,U]),K=n.a.useCallback(function(){var e=Object(u.a)(s.a.mark(function e(a){var r,n,c,l,i,p,m;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(p=function(){return(p=Object(u.a)(s.a.mark(function e(){var a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(Object(v.a)({id:t.id},b));case 2:a=e.sent,r=a.data,console.log("%cAdvert successfully deleted.","color: green; font-weight: bold;",r),d(T(Object(v.a)({id:t.id},r)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},i=function(){return p.apply(this,arguments)},l=function(){return(l=Object(u.a)(s.a.mark(function e(){var a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(Object(v.a)({id:t.id},b));case 2:a=e.sent,r=a.data,console.log("%cAdvert successfully updated.","color: green; font-weight: bold;",r),d(N(Object(v.a)({id:t.id},r)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},c=function(){return l.apply(this,arguments)},n=function(){return(n=Object(u.a)(s.a.mark(function e(){var t,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(b);case 2:t=e.sent,a=t.data,console.log("%cAdvert successfully added.","color: green; font-weight: bold;",a),d({type:C,advert:a});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},r=function(){return n.apply(this,arguments)},a.preventDefault(),e.prev=7,!(m=y(b,U))){e.next=12;break}return A(m),e.abrupt("return");case 12:L(!0),e.t0=o,e.next="add"===e.t0?16:"modify"===e.t0?19:"delete"===e.t0?22:25;break;case 16:return e.next=18,r();case 18:return e.abrupt("break",26);case 19:return e.next=21,c();case 21:return e.abrupt("break",26);case 22:return e.next=24,i();case 24:return e.abrupt("break",26);case 25:return e.abrupt("return");case 26:e.next=32;break;case 28:e.prev=28,e.t1=e.catch(7),L(!1),e.t1.response&&401===e.t1.response.status?(console.error("BAD PASSWORD!"),A({password:"Wrong password!"})):console.error(e.t1);case 32:case"end":return e.stop()}},e,null,[[7,28]])}));return function(t){return e.apply(this,arguments)}}(),[b,t,o,d,U]),W=n.a.useCallback(function(e){"Enter"===e.key&&K(e)},[K]),z=n.a.useCallback(function(e){e.preventDefault(),a()},[a]);return n.a.createElement("form",{className:"advert-form".concat(q?" loading":""),onSubmit:K},n.a.createElement("h1",null,c),"add"!==o&&n.a.createElement(P,{data:b,errors:g,name:"password",onChange:J,onKeyDown:W,placeholder:"Advert password...",type:"password",autoFocus:!0}),"delete"!==o&&n.a.createElement(n.a.Fragment,null,n.a.createElement(P,{data:b,errors:g,name:"title",onChange:J,onKeyDown:W,placeholder:"Advert title...",autoFocus:"add"===o}),n.a.createElement(I,{data:b,errors:g,name:"body",onChange:J,placeholder:"Advert content..."})),n.a.createElement(f,null,n.a.createElement(S,{onClick:z,text:"Cancel"}),n.a.createElement(S,{onClick:K,text:r,disabled:!B})))},L=a(12),U="adverts:setAdverts";function B(e){return{type:U,adverts:e}}var J="modal:openAddAdvertModal";var K="modal:openUpdateAdvertModal";var W="modal:openDeleteAdvertModal";var z="modal:closeAddAdvertModal";var G="modal:closeUpdateAdvertModal";var H="modal:closeDeleteAdvertModal";function Q(e,t){switch(console.debug("appReducer",{state:e,action:t}),t.type){case U:return Object(v.a)({},e,{adverts:t.adverts.sort(function(e,t){return t.id-e.id})});case C:return Object(v.a)({},e,{adverts:[t.advert].concat(Object(L.a)(e.adverts)),addAdvertModalOpen:!1});case M:var a=Object(L.a)(e.adverts);return a[a.findIndex(function(e){return e.id===t.advert.id})]=t.advert,Object(v.a)({},e,{adverts:a,updateAdvertModalOpen:!1});case D:return Object(v.a)({},e,{adverts:e.adverts.filter(function(e){return e.id!==t.advert.id}),deleteAdvertModalOpen:!1});case J:return Object(v.a)({},e,{addAdvertModalOpen:!0});case z:return Object(v.a)({},e,{addAdvertModalOpen:!1});case K:return Object(v.a)({},e,{updateAdvertModalOpen:!0,advertInModal:t.advert});case G:return Object(v.a)({},e,{updateAdvertModalOpen:!1});case W:return Object(v.a)({},e,{deleteAdvertModalOpen:!0,advertInModal:t.advert});case H:return Object(v.a)({},e,{deleteAdvertModalOpen:!1});default:return e}}var V={adverts:[],addAdvertModalOpen:!1,updateAdvertModalOpen:!1,deleteAdvertModalOpen:!1,advertInModal:{}},X=n.a.createContext(V);var Y=function(e){var t=e.children,a=n.a.useReducer(Q,V),r=Object(i.a)(a,2),c=r[0],o=r[1];return n.a.useEffect(function(){function e(){return(e=Object(u.a)(s.a.mark(function e(){var t,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A("get adverts"),w.a.get(g);case 3:t=e.sent,a=t.data,console.log("%cAdverts successfully fetched.","color: green; font-weight: bold;",a),o(B(a)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),alert("Fetching adverts error!"),console.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),n.a.createElement(X.Provider,{value:Object(v.a)({},c,{dispatch:o})},t)};var Z=function(){var e=n.a.useContext(X),t=e.addAdvertModalOpen,a=e.dispatch,r=n.a.useCallback(function(){a({type:z})},[a]);return n.a.createElement(d,{open:t,onClose:r},t&&n.a.createElement(q,{onCancel:r,submitText:"Add",headerText:"Add new advert",mode:"add",dispatch:a}))};var $=n.a.memo(function(e){var t=e.advert,a=e.dispatch,r=n.a.useState(!1),c=Object(i.a)(r,2),o=c[0],d=c[1],l=n.a.useCallback(function(){d(function(e){return!e})},[d]),s=n.a.useCallback(function(e){e.stopPropagation(),a(function(e){return{type:W,advert:e}}(t))},[a,t]),u=n.a.useCallback(function(e){e.stopPropagation(),a(function(e){return{type:K,advert:e}}(t))},[a,t]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"advert".concat(o?" expanded":""),onClick:l},n.a.createElement("div",{className:"advert-header"},t.title),n.a.createElement("div",{className:"advert-body"},t.body.split("\n").map(function(e,t){return n.a.createElement("p",{key:t},e)})),o&&n.a.createElement(f,null,n.a.createElement(S,{text:"Delete",onClick:s}),n.a.createElement(S,{text:"Modify",onClick:u}))))});var _=function(){var e=n.a.useContext(X),t=e.adverts,a=e.dispatch;return n.a.createElement("main",{className:"advert-list"},t.map(function(e){return n.a.createElement($,{key:e.id,advert:e,dispatch:a})}))};var ee=function(){var e=n.a.useContext(X).dispatch;return n.a.createElement("header",null,n.a.createElement("span",{className:"logo"},"Information board"),n.a.createElement("span",{className:"nav-clickable",onClick:function(){e({type:J})}},"New advert"))};var te=function(){var e=n.a.useContext(X),t=e.updateAdvertModalOpen,a=e.advertInModal,r=e.dispatch,c=n.a.useCallback(function(){r({type:G})},[r]);return n.a.createElement(d,{open:t,onClose:c},t&&n.a.createElement(q,{advert:a,onCancel:c,submitText:"Modify",headerText:"Modify advert",mode:"modify",dispatch:r}))};var ae=function(){var e=n.a.useContext(X),t=e.deleteAdvertModalOpen,a=e.advertInModal,r=e.dispatch,c=n.a.useCallback(function(){r({type:H})},[r]);return n.a.createElement(d,{open:t,onClose:c},t&&n.a.createElement(q,{advert:a,onCancel:c,submitText:"Delete",headerText:"Delete advert",mode:"delete",dispatch:r}))};var re=function(){return n.a.createElement(Y,null,n.a.createElement(ee,null),n.a.createElement(_,null),n.a.createElement(Z,null),n.a.createElement(te,null),n.a.createElement(ae,null))};a(45);o.a.render(n.a.createElement(re,null),document.getElementById("root"))}},[[19,1,2]]]);