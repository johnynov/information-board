(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(46)},45:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(9),o=a.n(c);var d=function(e){var t=e.children,a=e.open,r=e.onClose;return n.a.useEffect(function(){if(a){var e=function(e){"Escape"===e.key&&r()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}},[a,r]),a?o.a.createPortal(n.a.createElement("div",{className:"modal-background"},n.a.createElement("div",{className:"modal-container"},n.a.createElement("div",{className:"modal"},t))),document.body):null},l=a(3),s=a.n(l),u=a(5),i=a(6),v=a(4),p=a(1),m=a(7),f=a.n(m);var b=function(e){var t=e.children;return n.a.createElement("div",{className:"action-container"},t)};function h(e,t,a){var r=Object(p.a)({},t),n=function(e,t){var a=e.name,r=e.value,n=Object(u.a)({},a,r),c=Object(u.a)({},a,t[a]),o=f.a.validate(n,c).error;return o?o.details[0].message:null}(e,a);return n?r[e.name]=n:delete r[e.name],r}var w=a(8),E=a.n(w);E.a.defaults.baseURL="192.168.1.1";var O="/adverts";function y(e){var t=O,a=new FormData;return a.set("title",e.title),a.set("body",e.body),a.set("password",e.password),console.log('%cRequest: add advert, url: "%s", payload: ',"color: orange; font-weight: bold;",t,e),E.a.put(t,a)}function g(e){var t=e,a=O;return console.log('%cRequest: update advert, url: "%s", params: ',"color: orange; font-weight: bold;",a,t),E.a.patch(a,null,{params:t})}function x(e){var t=e.id,a=e.password,r=O,n={id:t,password:a};return console.log('%cRequest: delete advert, url: "%s", params: ',"color: orange; font-weight: bold;",r,n),E.a.delete(r,{params:n})}var k="adverts:addAdvert";var j="adverts:updateAdvert";function A(e){return{type:j,advert:e}}var C="adverts:deleteAdvert";function M(e){return{type:C,advert:e}}var N=a(10);var T=function(e){var t=e.data,a=e.errors,r=e.name,c=Object(N.a)(e,["data","errors","name"]),o=t[r],d=a[r],l=o.split("\n").length;return n.a.createElement("div",{className:"input-wrapper"},n.a.createElement("textarea",Object.assign({className:"input".concat(d?" with-error":""),id:r,name:r,value:o,rows:l},c)),d&&n.a.createElement("div",{className:"input-error"},d))};var D=function(e){var t=e.disabled,a=e.onClick,r=e.text;return n.a.createElement("button",{className:"btn",disabled:t,onClick:a},r)};var I=function(e){var t=e.data,a=e.errors,r=e.name,c=Object(N.a)(e,["data","errors","name"]),o=t[r],d=a[r];return n.a.createElement("div",{className:"input-wrapper"},n.a.createElement("input",Object.assign({className:"input".concat(d?" with-error":""),id:r,name:r,value:o},c)),d&&n.a.createElement("div",{className:"input-error"},d))},q={title:f.a.string().required().min(3).max(128).label("Title"),body:f.a.string().required().min(3).max(256).label("Content")},R={password:f.a.string().required().min(3).max(64).label("Password")};var P=function(e){var t=e.advert,a=e.onCancel,r=e.submitText,c=e.headerText,o=e.mode,d=e.dispatch,l=n.a.useState(function(e,t){switch(e){case"add":return{title:"",body:"",password:""};case"modify":return{title:t&&t.title||"",body:t&&t.body||"",password:""};case"delete":return{password:""};default:return null}}(o,t)),m=Object(v.a)(l,2),w=m[0],E=m[1],O=n.a.useState({}),j=Object(v.a)(O,2),C=j[0],N=j[1],P=n.a.useState(!1),F=Object(v.a)(P,2),S=F[0],U=F[1],L=n.a.useMemo(function(){return function(e){switch(e){case"add":case"modify":return Object(p.a)({},q,R);case"delete":return R;default:return null}}(o)},[o]),B=n.a.useMemo(function(){var e=function(e,t){var a=f.a.validate(e,t,{abortEarly:!1}).error;return!Boolean(a)}(w,L),t=Object.keys(C).length;return e&&!t},[w,C,L]),J=n.a.useCallback(function(e){var t=e.currentTarget,a=function(e,t){var a=e.name,r=e.value,n=Object(p.a)({},t);return n[a]=r,n}(t,w),r=h(t,C,L);E(a),N(r)},[w,E,C,N,L]),z=n.a.useCallback(function(){var e=Object(i.a)(s.a.mark(function e(a){var r,n,c,l,v,m,f,b,h;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:m=function(){return(m=Object(i.a)(s.a.mark(function e(){var a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(Object(p.a)({id:t.id},w));case 2:a=e.sent,r=a.data,console.log("%cAdvert successfully deleted.","color: green; font-weight: bold;",r),d(M(Object(p.a)({id:t.id},r)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},v=function(){return m.apply(this,arguments)},l=function(){return(l=Object(i.a)(s.a.mark(function e(){var a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(Object(p.a)({id:t.id},w));case 2:a=e.sent,r=a.data,console.log("%cAdvert successfully updated.","color: green; font-weight: bold;",r),d(A(Object(p.a)({id:t.id},r)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},c=function(){return l.apply(this,arguments)},n=function(){return(n=Object(i.a)(s.a.mark(function e(){var t,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(w);case 2:t=e.sent,a=t.data,console.log("%cAdvert successfully added.","color: green; font-weight: bold;",a),d({type:k,advert:a});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},r=function(){return n.apply(this,arguments)},a.preventDefault(),U(!0),e.prev=8,e.t0=o,e.next="add"===e.t0?12:"modify"===e.t0?15:"delete"===e.t0?18:21;break;case 12:return e.next=14,r();case 14:return e.abrupt("break",22);case 15:return e.next=17,c();case 17:return e.abrupt("break",22);case 18:return e.next=20,v();case 20:return e.abrupt("break",22);case 21:return e.abrupt("return");case 22:e.next=28;break;case 24:e.prev=24,e.t1=e.catch(8),U(!1),e.t1.response&&[400,401].includes(e.t1.response.status)?(f=e.t1.response.data||{},b=f.field,h=f.message,console.error("error",e.t1.response.data),N(Object(u.a)({},b,h))):(console.error("unknown error: ",e.t1),N({password:"Unknown error"}));case 28:case"end":return e.stop()}},e,null,[[8,24]])}));return function(t){return e.apply(this,arguments)}}(),[w,t,o,d]),G=n.a.useCallback(function(e){e.preventDefault(),a()},[a]);return n.a.createElement("form",{className:"advert-form".concat(S?" loading":"")},n.a.createElement("h1",null,c),n.a.createElement(I,{data:w,errors:C,name:"password",onChange:J,placeholder:"Advert password...",type:"password"}),"delete"!==o&&n.a.createElement(n.a.Fragment,null,n.a.createElement(I,{data:w,errors:C,name:"title",onChange:J,placeholder:"Advert title..."}),n.a.createElement(T,{data:w,errors:C,name:"body",onChange:J,placeholder:"Advert content..."})),n.a.createElement(b,null,n.a.createElement(D,{onClick:G,text:"Cancel"}),n.a.createElement(D,{onClick:z,text:r,disabled:!B})))},F=a(12),S="adverts:setAdverts";function U(e){return{type:S,adverts:e}}var L="modal:openAddAdvertModal";var B="modal:openUpdateAdvertModal";var J="modal:openDeleteAdvertModal";var z="modal:closeAddAdvertModal";var G="modal:closeUpdateAdvertModal";var H="modal:closeDeleteAdvertModal";function K(e,t){switch(console.debug("appReducer",{state:e,action:t}),t.type){case S:return Object(p.a)({},e,{adverts:t.adverts.sort(function(e,t){return t.id-e.id})});case k:return Object(p.a)({},e,{adverts:[t.advert].concat(Object(F.a)(e.adverts)),addAdvertModalOpen:!1});case j:var a=Object(F.a)(e.adverts);return a[a.findIndex(function(e){return e.id===t.advert.id})]=t.advert,Object(p.a)({},e,{adverts:a,updateAdvertModalOpen:!1});case C:return Object(p.a)({},e,{adverts:e.adverts.filter(function(e){return e.id!==t.advert.id}),deleteAdvertModalOpen:!1});case L:return Object(p.a)({},e,{addAdvertModalOpen:!0});case z:return Object(p.a)({},e,{addAdvertModalOpen:!1});case B:return Object(p.a)({},e,{updateAdvertModalOpen:!0,advertInModal:t.advert});case G:return Object(p.a)({},e,{updateAdvertModalOpen:!1});case J:return Object(p.a)({},e,{deleteAdvertModalOpen:!0,advertInModal:t.advert});case H:return Object(p.a)({},e,{deleteAdvertModalOpen:!1});default:return e}}var Q={adverts:[],addAdvertModalOpen:!1,updateAdvertModalOpen:!1,deleteAdvertModalOpen:!1,advertInModal:{}},V=n.a.createContext(Q);var W=function(e){var t=e.children,a=n.a.useReducer(K,Q),r=Object(v.a)(a,2),c=r[0],o=r[1];return n.a.useEffect(function(){function e(){return(e=Object(i.a)(s.a.mark(function e(){var t,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,console.log("%cRequest: get adverts","color: orange; font-weight: bold;"),E.a.get(O);case 3:t=e.sent,a=t.data,console.log("%cAdverts successfully fetched.","color: green; font-weight: bold;",a),o(U(a)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),alert("Fetching adverts error!"),console.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),n.a.createElement(V.Provider,{value:Object(p.a)({},c,{dispatch:o})},t)};var X=function(){var e=n.a.useContext(V),t=e.addAdvertModalOpen,a=e.dispatch,r=n.a.useCallback(function(){a({type:z})},[a]);return n.a.createElement(d,{open:t,onClose:r},t&&n.a.createElement(P,{onCancel:r,submitText:"Add",headerText:"Add new advert",mode:"add",dispatch:a}))};var Y=n.a.memo(function(e){var t=e.advert,a=e.dispatch,r=n.a.useState(!1),c=Object(v.a)(r,2),o=c[0],d=c[1],l=n.a.useCallback(function(){d(function(e){return!e})},[d]),s=n.a.useCallback(function(e){e.stopPropagation(),a(function(e){return{type:J,advert:e}}(t))},[a,t]),u=n.a.useCallback(function(e){e.stopPropagation(),a(function(e){return{type:B,advert:e}}(t))},[a,t]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"advert".concat(o?" expanded":""),onClick:l},n.a.createElement("div",{className:"advert-title"},t.title),n.a.createElement("div",{className:"advert-body"},t.body.split("\n").map(function(e,t){return n.a.createElement("p",{key:t},e)})),o&&n.a.createElement(b,null,n.a.createElement(D,{text:"Delete",onClick:s}),n.a.createElement(D,{text:"Modify",onClick:u}))))});var Z=function(){var e=n.a.useContext(V),t=e.adverts,a=e.dispatch;return n.a.createElement("main",{className:"adverts"},t.map(function(e){return n.a.createElement(Y,{key:e.id,advert:e,dispatch:a})}))};var $=function(){var e=n.a.useContext(V).dispatch;return n.a.createElement("header",null,n.a.createElement("span",{className:"logo"},"Information board"),n.a.createElement("span",{className:"nav-clickable",onClick:function(){e({type:L})}},"New advert"))};var _=function(){var e=n.a.useContext(V),t=e.updateAdvertModalOpen,a=e.advertInModal,r=e.dispatch,c=n.a.useCallback(function(){r({type:G})},[r]);return n.a.createElement(d,{open:t,onClose:c},t&&n.a.createElement(P,{advert:a,onCancel:c,submitText:"Modify",headerText:"Modify advert",mode:"modify",dispatch:r}))};var ee=function(){var e=n.a.useContext(V),t=e.deleteAdvertModalOpen,a=e.advertInModal,r=e.dispatch,c=n.a.useCallback(function(){r({type:H})},[r]);return n.a.createElement(d,{open:t,onClose:c},t&&n.a.createElement(P,{advert:a,onCancel:c,submitText:"Delete",headerText:"Delete advert",mode:"delete",dispatch:r}))};var te=function(){return n.a.createElement(W,null,n.a.createElement($,null),n.a.createElement(Z,null),n.a.createElement(X,null),n.a.createElement(_,null),n.a.createElement(ee,null))};a(45);o.a.render(n.a.createElement(te,null),document.getElementById("root"))}},[[19,1,2]]]);