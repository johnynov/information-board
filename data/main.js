(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(46)},45:function(e,t,a){},46:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(9),o=a.n(c);var d=function(e){var t=e.children,a=e.open,r=e.onClose;return n.a.useEffect(function(){if(a){var e=function(e){"Escape"===e.key&&r()};return window.addEventListener("keydown",e),function(){window.removeEventListener("keydown",e)}}},[a,r]),a?o.a.createPortal(n.a.createElement("div",{className:"modal-background"},n.a.createElement("div",{className:"modal-container"},n.a.createElement("div",{className:"modal"},t))),document.body):null},l=a(3),s=a.n(l),u=a(5),i=a(4),v=a(1),p=a(6),m=a.n(p);var f=function(e){var t=e.children;return n.a.createElement("div",{className:"action-container"},t)},b=a(8);function h(e,t,a){var r=Object(v.a)({},t),n=function(e,t){var a=e.name,r=e.value,n=Object(b.a)({},a,r),c=Object(b.a)({},a,t[a]),o=m.a.validate(n,c).error;return o?o.details[0].message:null}(e,a);return n?r[e.name]=n:delete r[e.name],r}var w=a(7),E=a.n(w);E.a.defaults.baseURL="http://192.168.1.1";var O="/advert";function y(e){var t=O,a=new FormData;return a.set("title",e.title),a.set("body",e.body),a.set("password",e.password),console.log('%cRequest: add advert, url: "%s", payload: ',"color: orange; font-weight: bold;",t,e),E.a.put(t,a)}function g(e){var t=e,a=O;return console.log('%cRequest: update advert, url: "%s", params: ',"color: orange; font-weight: bold;",a,t),E.a.patch(a,null,{params:t})}function x(e){var t=e.id,a=e.password,r=O,n={id:t,password:a};return console.log('%cRequest: delete advert, url: "%s", params: ',"color: orange; font-weight: bold;",r,n),E.a.delete(r,{params:n})}var k="adverts:addAdvert";var A="adverts:updateAdvert";function j(e){return{type:A,advert:e}}var C="adverts:deleteAdvert";function M(e){return{type:C,advert:e}}var N=a(10);var D=function(e){var t=e.data,a=e.errors,r=e.name,c=Object(N.a)(e,["data","errors","name"]),o=t[r],d=a[r],l=o.split("\n").length;return n.a.createElement("div",{className:"input-wrapper"},n.a.createElement("textarea",Object.assign({className:"input".concat(d?" with-error":""),id:r,name:r,value:o,rows:l},c)),d&&n.a.createElement("div",{className:"input-error"},d))};var T=function(e){var t=e.disabled,a=e.onClick,r=e.text;return n.a.createElement("button",{className:"btn",disabled:t,onClick:a},r)};var I=function(e){var t=e.data,a=e.errors,r=e.name,c=Object(N.a)(e,["data","errors","name"]),o=t[r],d=a[r];return n.a.createElement("div",{className:"input-wrapper"},n.a.createElement("input",Object.assign({className:"input".concat(d?" with-error":""),id:r,name:r,value:o},c)),d&&n.a.createElement("div",{className:"input-error"},d))},R={title:m.a.string().required().min(3).max(128).label("Title"),body:m.a.string().required().min(3).max(256).label("Content")},q={password:m.a.string().required().min(3).max(64).label("Password")};var P=function(e){var t=e.advert,a=e.onCancel,r=e.submitText,c=e.headerText,o=e.mode,d=e.dispatch,l=n.a.useState(function(e,t){switch(e){case"add":return{title:"",body:"",password:""};case"modify":return{title:t&&t.title||"",body:t&&t.body||"",password:""};case"delete":return{password:""};default:return null}}(o,t)),p=Object(i.a)(l,2),b=p[0],w=p[1],E=n.a.useState({}),O=Object(i.a)(E,2),A=O[0],C=O[1],N=n.a.useState(!1),P=Object(i.a)(N,2),S=P[0],F=P[1],B=n.a.useMemo(function(){return function(e){switch(e){case"add":case"modify":return Object(v.a)({},R,q);case"delete":return q;default:return null}}(o)},[o]),L=n.a.useMemo(function(){var e=function(e,t){var a=m.a.validate(e,t,{abortEarly:!1}).error;return!Boolean(a)}(b,B),t=Object.keys(A).length;return e&&!t},[b,A,B]),U=n.a.useCallback(function(e){var t=e.currentTarget,a=function(e,t){var a=e.name,r=e.value,n=Object(v.a)({},t);return n[a]=r,n}(t,b),r=h(t,A,B);w(a),C(r)},[b,w,A,C,B]),J=n.a.useCallback(function(){var e=Object(u.a)(s.a.mark(function e(a){var r,n,c,l,i,p;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:p=function(){return(p=Object(u.a)(s.a.mark(function e(){var a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x(Object(v.a)({id:t.id},b));case 2:a=e.sent,r=a.data,console.log("%cAdvert successfully deleted.","color: green; font-weight: bold;",r),d(M(Object(v.a)({id:t.id},r)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},i=function(){return p.apply(this,arguments)},l=function(){return(l=Object(u.a)(s.a.mark(function e(){var a,r;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(Object(v.a)({id:t.id},b));case 2:a=e.sent,r=a.data,console.log("%cAdvert successfully updated.","color: green; font-weight: bold;",r),d(j(Object(v.a)({id:t.id},r)));case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},c=function(){return l.apply(this,arguments)},n=function(){return(n=Object(u.a)(s.a.mark(function e(){var t,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(b);case 2:t=e.sent,a=t.data,console.log("%cAdvert successfully added.","color: green; font-weight: bold;",a),d({type:k,advert:a});case 6:case"end":return e.stop()}},e)}))).apply(this,arguments)},r=function(){return n.apply(this,arguments)},a.preventDefault(),F(!0),e.prev=8,e.t0=o,e.next="add"===e.t0?12:"modify"===e.t0?15:"delete"===e.t0?18:21;break;case 12:return e.next=14,r();case 14:return e.abrupt("break",22);case 15:return e.next=17,c();case 17:return e.abrupt("break",22);case 18:return e.next=20,i();case 20:return e.abrupt("break",22);case 21:return e.abrupt("return");case 22:e.next=28;break;case 24:e.prev=24,e.t1=e.catch(8),F(!1),e.t1.response&&401===e.t1.response.status?(console.error("BAD PASSWORD!"),C({password:"Wrong password!"})):console.error(e.t1);case 28:case"end":return e.stop()}},e,null,[[8,24]])}));return function(t){return e.apply(this,arguments)}}(),[b,t,o,d]),W=n.a.useCallback(function(e){e.preventDefault(),a()},[a]);return n.a.createElement("form",{className:"advert-form".concat(S?" loading":"")},n.a.createElement("h1",null,c),n.a.createElement(I,{data:b,errors:A,name:"password",onChange:U,placeholder:"Advert password...",type:"password"}),"delete"!==o&&n.a.createElement(n.a.Fragment,null,n.a.createElement(I,{data:b,errors:A,name:"title",onChange:U,placeholder:"Advert title..."}),n.a.createElement(D,{data:b,errors:A,name:"body",onChange:U,placeholder:"Advert content..."})),n.a.createElement(f,null,n.a.createElement(T,{onClick:W,text:"Cancel"}),n.a.createElement(T,{onClick:J,text:r,disabled:!L})))},S=a(12),F="adverts:setAdverts";function B(e){return{type:F,adverts:e}}var L="modal:openAddAdvertModal";var U="modal:openUpdateAdvertModal";var J="modal:openDeleteAdvertModal";var W="modal:closeAddAdvertModal";var z="modal:closeUpdateAdvertModal";var G="modal:closeDeleteAdvertModal";function H(e,t){switch(console.debug("appReducer",{state:e,action:t}),t.type){case F:return Object(v.a)({},e,{adverts:t.adverts.sort(function(e,t){return t.id-e.id})});case k:return Object(v.a)({},e,{adverts:[t.advert].concat(Object(S.a)(e.adverts)),addAdvertModalOpen:!1});case A:var a=Object(S.a)(e.adverts);return a[a.findIndex(function(e){return e.id===t.advert.id})]=t.advert,Object(v.a)({},e,{adverts:a,updateAdvertModalOpen:!1});case C:return Object(v.a)({},e,{adverts:e.adverts.filter(function(e){return e.id!==t.advert.id}),deleteAdvertModalOpen:!1});case L:return Object(v.a)({},e,{addAdvertModalOpen:!0});case W:return Object(v.a)({},e,{addAdvertModalOpen:!1});case U:return Object(v.a)({},e,{updateAdvertModalOpen:!0,advertInModal:t.advert});case z:return Object(v.a)({},e,{updateAdvertModalOpen:!1});case J:return Object(v.a)({},e,{deleteAdvertModalOpen:!0,advertInModal:t.advert});case G:return Object(v.a)({},e,{deleteAdvertModalOpen:!1});default:return e}}var K={adverts:[],addAdvertModalOpen:!1,updateAdvertModalOpen:!1,deleteAdvertModalOpen:!1,advertInModal:{}},Q=n.a.createContext(K);var V=function(e){var t=e.children,a=n.a.useReducer(H,K),r=Object(i.a)(a,2),c=r[0],o=r[1];return n.a.useEffect(function(){function e(){return(e=Object(u.a)(s.a.mark(function e(){var t,a;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,console.log("%cRequest: get adverts","color: orange; font-weight: bold;"),E.a.get(O);case 3:t=e.sent,a=t.data,console.log("%cAdverts successfully fetched.","color: green; font-weight: bold;",a),o(B(a)),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),alert("Fetching adverts error!"),console.error(e.t0);case 13:case"end":return e.stop()}},e,null,[[0,9]])}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[]),n.a.createElement(Q.Provider,{value:Object(v.a)({},c,{dispatch:o})},t)};var X=function(){var e=n.a.useContext(Q),t=e.addAdvertModalOpen,a=e.dispatch,r=n.a.useCallback(function(){a({type:W})},[a]);return n.a.createElement(d,{open:t,onClose:r},t&&n.a.createElement(P,{onCancel:r,submitText:"Add",headerText:"Add new advert",mode:"add",dispatch:a}))};var Y=n.a.memo(function(e){var t=e.advert,a=e.dispatch,r=n.a.useState(!1),c=Object(i.a)(r,2),o=c[0],d=c[1],l=n.a.useCallback(function(){d(function(e){return!e})},[d]),s=n.a.useCallback(function(e){e.stopPropagation(),a(function(e){return{type:J,advert:e}}(t))},[a,t]),u=n.a.useCallback(function(e){e.stopPropagation(),a(function(e){return{type:U,advert:e}}(t))},[a,t]);return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"advert".concat(o?" expanded":""),onClick:l},n.a.createElement("div",{className:"advert-title"},t.title),n.a.createElement("div",{className:"advert-body"},t.body.split("\n").map(function(e,t){return n.a.createElement("p",{key:t},e)})),o&&n.a.createElement(f,null,n.a.createElement(T,{text:"Delete",onClick:s}),n.a.createElement(T,{text:"Modify",onClick:u}))))});var Z=function(){var e=n.a.useContext(Q),t=e.adverts,a=e.dispatch;return n.a.createElement("main",{className:"adverts"},t.map(function(e){return n.a.createElement(Y,{key:e.id,advert:e,dispatch:a})}))};var $=function(){var e=n.a.useContext(Q).dispatch;return n.a.createElement("header",null,n.a.createElement("span",{className:"logo"},"Information board"),n.a.createElement("span",{className:"nav-clickable",onClick:function(){e({type:L})}},"New advert"))};var _=function(){var e=n.a.useContext(Q),t=e.updateAdvertModalOpen,a=e.advertInModal,r=e.dispatch,c=n.a.useCallback(function(){r({type:z})},[r]);return n.a.createElement(d,{open:t,onClose:c},t&&n.a.createElement(P,{advert:a,onCancel:c,submitText:"Modify",headerText:"Modify advert",mode:"modify",dispatch:r}))};var ee=function(){var e=n.a.useContext(Q),t=e.deleteAdvertModalOpen,a=e.advertInModal,r=e.dispatch,c=n.a.useCallback(function(){r({type:G})},[r]);return n.a.createElement(d,{open:t,onClose:c},t&&n.a.createElement(P,{advert:a,onCancel:c,submitText:"Delete",headerText:"Delete advert",mode:"delete",dispatch:r}))};var te=function(){return n.a.createElement(V,null,n.a.createElement($,null),n.a.createElement(Z,null),n.a.createElement(X,null),n.a.createElement(_,null),n.a.createElement(ee,null))};a(45);o.a.render(n.a.createElement(te,null),document.getElementById("root"))}},[[19,1,2]]]);